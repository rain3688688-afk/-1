import { useState, useEffect, useRef } from 'react';
import { createClient } from '@supabase/supabase-js';
import Head from 'next/head';

// ==========================================
// 1. 系统配置 & 工具
// ==========================================

const supabase = createClient(
  process.env.NEXT_PUBLIC_SUPABASE_URL,
  process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY
);

const wait = (ms) => new Promise(resolve => setTimeout(resolve, ms));

// ==========================================
// 2. 核心数据 (完整版 48题 + 8结果)
// ==========================================

const DIM_MAP = {
  1: { id: 1, label: "确定感", color: "#A8A29E", bg: "#F5F5F4", totem: "深扎的树根 / 磐石" }, // Stone
  2: { id: 2, label: "被需要", color: "#F97316", bg: "#FFF7ED", totem: "温顺的金毛 / 壁炉之火" }, // Orange
  3: { id: 3, label: "掌控感", color: "#64748B", bg: "#F8FAFC", totem: "高速公路 / 船长" }, // Slate
  4: { id: 4, label: "被偏爱", color: "#F43F5E", bg: "#FFF1F2", totem: "被驯服的狐狸 / 草莓尖尖" }, // Rose
  5: { id: 5, label: "精神共鸣", color: "#6366F1", bg: "#EEF2FF", totem: "互映的镜子 / 深夜书房" }, // Indigo
  6: { id: 6, label: "自由感", color: "#0EA5E9", bg: "#F0F9FF", totem: "飘浮的云 / 落地窗" }, // Sky
  7: { id: 7, label: "安全距离", color: "#10B981", bg: "#ECFDF5", totem: "林间小鹿 / 降噪耳机" }, // Emerald
  8: { id: 8, label: "秩序感", color: "#3B82F6", bg: "#EFF6FF", totem: "囤粮松鼠 / 契约" }  // Blue
};

// 结果文案 (基于答案2.0.docx，已结构化拆分)
const RESULTS = {
  1: {
    title: "确定感",
    keyword: "风暴中的守夜人",
    quote: "万物皆流变，而我只要一种绝对的定数。",
    tags: ["#契约精神", "#长期主义", "#抗风险"],
    summary: "你的核心诉求是“稳定与可预期”。你对“凡事有交代、件件有着落”有着近乎执着的追求。",
    sections: [
      { t: "你的亲密底色", c: "在亲密关系中，你核心的情感诉求是“稳定与可预期”，始终坚守着对长期联结的极致追求。相较于外在条件的光鲜或浪漫形式的轰轰烈烈，你更看重关系中的确定性—— 凡事有交代、件件有着落、事事有回音，这种清晰、可靠的互动模式，是你构建情感安全感的基石。\n\n你的情感底色厚重且带着强烈的契约精神，对感情的投入从不浅尝辄止，而是带着 “认定即终身” 的郑重。只要对方传递的态度足够明确、信号足够清晰，你便会毫无保留地深度投入，愿意为关系的长久发展付出耐心与精力，包容差异、共担责任，将长期承诺作为情感的核心导向，而非一时的情绪冲动。\n\n这份对关系的厚重期待背后，潜藏着你对不确定性的极度敏感与对被抛弃的深层恐惧。你对关系中的距离变化、态度波动有着本能的警觉，任何模糊的信号、延迟的回应，都可能触发你内心的不安。你并非刻意试探或控制，所有看似执着的追问与确认，本质上都是为了在不确定的关系流动中，寻找一个稳定的情感锚点，反复确认自身在对方心中的重要性与不可替代性。" },
      { t: "你的光：天赋优势", c: "1. 稳定的情感支撑力\n你是关系中定海神针般的存在，具备极强的抗风险韧性。不会因短期矛盾或外界波动轻易放弃联结，始终以长期视角对待关系，能为对方提供可依赖的情感锚点，尤其在关系遭遇压力时，更能展现出坚定的守护姿态。\n\n2. 纯粹的情感忠诚度\n你的情感投入具有极强的排他性与专注度，拒绝 “骑驴找马”“留退路” 等模糊模式。一旦确立联结，便会毫无保留地全心投入，将 “忠诚” 内化为关系的核心准则，这份纯粹性让对方能感受到强烈的被重视感。\n\n3. 主动的关系修复力\n面对关系裂痕，你倾向于解决问题而非逃避冲突。具备主动沟通、磨合调整的意识，愿意为关系的长久性付出精力，始终以 “巩固联结、延续稳定” 为目标，展现出务实的经营能力。" },
      { t: "你的影：隐性挑战", c: "1. 对模糊信号的过度敏感\n难以耐受关系中的信息空白，当对方出现沉默、回避等不确定行为时，易陷入过度解读与自我归因，将中性信号转化为被否定、被厌倦的负面预判，进而引发内心焦虑。\n\n2. 以体谅为名的需求压抑\n因恐惧成为对方的 “负担”，常以 “懂事”“体谅” 为借口，刻意隐藏自身的情感需求与不安。表面上的 “没事，你去忙”，本质是对真实情绪的压抑，长期积累易导致自我消耗与关系失衡。\n\n3. 对未来的焦虑性预判\n受怕失去的深层恐惧驱动，习惯对关系走向做负面预设，难以全然接纳当下的美好。这种对 稳定感的过度渴求，会转化为持续的焦虑，阻碍你沉浸式体验关系中的正向反馈与快乐。" },
      { t: "给爱你的TA", isForPartner: true, c: "1. 你的追问，从不是找茬，是在求一份安心\n当你反复问 “去哪了”“在干嘛”“爱不爱我” 时，别嫌我烦 —— 那一刻我正被不安包裹。你不用跟我讲道理，只要抱抱我说 “我在，别怕”，就够了。\n\n2. 你的 “报备”，是我的定心丸\n我不要求你秒回消息，但真的怕你突然失联。如果你要忙、或者心情不好想静一静，提前说一句 “我忙会儿，晚点找你”，就能让我从心慌落到踏实。\n\n3. 关键时刻，请坚定地偏向我\n我不用你对抗全世界，但需要知道：在我和别人之间，你会本能地护着我。任何犹豫、迟疑，或是 “先讲道理再顾我”，在我眼里都会变成 “我不重要” 的信号。" },
      { t: "深度溯源", c: "从依恋理论视角来看，你对确定感的极致渴求，本质是焦虑型依恋模式的典型呈现。你可能曾经历过照顾者回应的不稳定性：有时把你宠成宝贝，有时却莫名冷淡。这种不可预测的环境，让你从小就被迫活在“不确定”里，时刻绷紧神经留意信号。这份深埋心底的“爱随时可能消失”的恐惧，让你在亲密关系中本能地执着于“确定感”，只为填补童年从未被满足的安全渴求。" },
      { t: "自我重塑", c: "1. 练习事实归因：停止对模糊信号的灾难化解读\n当对方沉默时，告诉自己：“他现在没说话可能是忙，和我们的关系无关”。养成先看事实，再做判断的习惯。\n\n2. 建立爱的韧性认知\n爱不是持续输出的电流，而是有蓄电功能的电池。偶尔的沉默、疏离，只是暂时的能量补给，不是电量耗尽。相信你们的联结比你想象中更坚韧。\n\n3. 构建自我价值支撑体系\n把情绪重心从对方身上收回。无论深耕爱好还是拓展社交，当自身的“快乐账户”足够充盈，就不会再过度依赖对方的“情绪转账”。" },
      { t: "祝福", c: "愿你在世事浮沉的人间，能遇见一个懂你敏感、护你不安的人 —— 他不必为你画地为牢，却愿意为你停下匆忙的脚步；不必许你永远，却能在你慌慌张张试探时，给你一份 “我一直都在” 的笃定。\n\n更愿你修炼出一颗稳稳的内心：不再把安全感寄托于他人的回应，不再把价值感捆绑于关系的稳定。当你真正相信 “无论是否被坚定选择，我本身就值得被好好爱着”，便会发现 —— 最坚实的依靠从不是别人的承诺，而是自己给的底气。" }
    ]
  },
  2: {
    title: "被需要",
    keyword: "温情的守护者",
    quote: "没有你，我只是一片废墟。",
    tags: ["#付出型", "#价值确认", "#互惠平衡"],
    summary: "你的爱是实打实的“我能为你做什么”。比起甜言蜜语，你更在意自己的存在能让对方生活变轻松。",
    sections: [
      { t: "你的亲密底色", c: "在亲密关系里，你最核心的需求是靠被对方依赖来确认自己的价值。对别人来说，爱可能是鲜花、情话和浪漫仪式，但对你而言，爱从来都是实打实的联结 —— 是“我能为你做什么”，是 “我的存在能让你少操心”。比起嘴上说得好听的甜言蜜语，你更在意自己的存在能让对方的生活变轻松，这种被需要的踏实反馈，才是你心里最安稳的安全感来源。\n\n你的情感底色里，藏着一种付出才值得被爱的本能认知。你会本能地盯着对方的生活细节：他加班晚了，你会提前煮好热饭；他遇到麻烦了，你会第一时间凑上去帮忙。这些付出不是刻意讨好，只是真心想成为他生活里离不了的人。在你看来，被依赖就意味着自己在这段关系里不可替代。\n\n可这份对 “被需要” 的执念背后，藏着你最怕的事 —— 怕自己是可有可无的。要是对方凡事都自己扛，不愿麻烦你，你会悄悄觉得“原来没有我，他也能过得挺好”。你不是想控制谁，只是需要通过一次次被他需要的小事，反复确认自己在他心里的分量。" },
      { t: "你的光：天赋优势", c: "1. 靠谱的务实支撑力\n你是对方生活里最踏实的后盾，从来不会只说漂亮话。比起口头安慰，你更愿意用实打实的行动帮忙 —— 他工作卡壳时你搭把手出主意，生活忙乱时你默默扛起琐事，那种 “不管有事没事，我都在” 的态度，能让他真真切切感受到安全感。\n\n2. 暖心的情感联结力\n你特别会察言观色，能捕捉到他没说出口的需求 —— 比如他强撑着说 “没事” 时的疲惫。这种被看见、被照顾的感觉，会让他越来越依赖你，让两个人的关系满是温度。\n\n3. 清醒的互惠平衡感\n你不是那种一味付出的傻好人，心里很清楚感情需要你来我往。你愿意为关系兜底、多做一点，但也盼着对方能看见你的付出，偶尔也回应你的需求。" },
      { t: "你的影：隐性挑战", c: "1. 价值感绑在 “被需要” 上\n你总不自觉把 “他需不需要我” 和 “我重不重要” 绑在一起。要是他暂时能自己处理事情，你容易胡思乱想：“原来没有我也可以”，甚至悄悄觉得自己没那么有价值了。\n\n2. 不敢直说 “我也想被你需要”\n你心里其实很期待他主动找你帮忙，但又怕说出来会给对方压力。所以你宁愿默默付出，等着对方主动来需要自己，明明心里很期待，嘴上却要装大方：“没事，你自己搞定就好”，最后变成了失落。\n\n3. 过度承担把自己累垮\n因为悄悄担心他累着，也怕他不再需要自己，你会不自觉把好多活都揽过来。久而久之，付出变成了沉重的负担，你陷入 “越付出越累，越累越怕他离开” 的循环里。" },
      { t: "给爱你的TA", isForPartner: true, c: "1. TA 说我来吧，其实是最直接的爱意表达\n当 TA 主动提出帮你处理琐事、分担压力时，别随口说不用不用。在 TA 心里，接受这份帮助从来不是麻烦，而是对 TA 自身价值的肯定。\n\n2. 主动向 TA 求助，是最珍贵的认可\n偶尔说一句“这件事我搞不定，你能陪我一下吗”，或者“我今天好累，想让你帮我煮碗面”，会让 TA 瞬间感受到被信任、被需要的重量，这种肯定比任何甜言蜜语都管用。\n\n3. TA 的过度照顾，背后藏着怕失去你的不安\n当 TA 做得太多时，别直接反驳。温柔地抱住 TA，告诉 TA：“我知道你心疼我，但你已经很重要了，不用这么拼命。”让 TA 知道，你需要的是 TA 这个人，而不是不停的付出。" },
      { t: "深度溯源", c: "这往往与童年里“懂事才能被爱”的体验有关。你可能很早就学会了体谅，发现只有当自己能帮上忙、会照顾人时，才能获得更多关注。久而久之，“能帮上忙=被需要=被爱”的认知沉淀在潜意识里。你习惯了用付出换取被看见的机会，却渐渐忘了：你也可以只是单纯做自己，不用刻意付出什么，就值得被好好爱着。" },
      { t: "自我重塑", c: "1. 先学会不付出，也敢安心被爱\n下次对方独自搞定某件事，别再悄悄失落。告诉自己：他能独立是好事，自己哪怕什么都不做，陪伴和存在本身对他来说同样珍贵。\n\n2. 坦然说我也需要被照顾\n你总怕麻烦别人，却忘了连结是双向流动的。累的时候直接说“今天没力气”，难过的时候说“想让你陪我聊聊天”。真正在乎你的人，会因为能为你做点什么而开心。\n\n3. 拓展自我价值的边界\n深耕一个喜欢的爱好，投入工作提升能力，多和朋友相处。你会发现，除了爱情，还有很多人在乎你，自己的价值从来不是单一维度的。" },
      { t: "祝福", c: "愿你遇见这样一个人：他会珍惜你为他做的每一件事，也会主动为你分担疲惫；他会依赖你的照顾，也会把你的需求放在心上；他会告诉你：“有你帮忙很好，但没有你，我也一样在乎你”。\n\n更愿你慢慢活成自己的底气：不用靠付出换爱，不用靠有用换存在感，哪怕什么都不做，也能坦然相信 “我值得被好好爱着”。" }
    ]
  },
  3: {
    title: "掌控感",
    keyword: "并肩的掌舵者",
    quote: "我抛开了所有理智，只求你结束我的痛苦。",
    tags: ["#关系梳理", "#共同目标", "#秩序建立"],
    summary: "你渴望的不是控制，而是关系的可预期与协同。亲密关系对你像一艘船，必须校准航向、明确规则。",
    sections: [
      { t: "你的亲密底色", c: "在亲密关系里，你最核心的需求从不是控制对方，而是关系的可预期、可沟通、可协同。对别人来说，爱或许是即兴陪伴、模糊留白，但对你而言，亲密更像两人共掌舵的船，得提前校准航向、明确规则、同步节奏，你才能放下顾虑，放心交付自己。\n\n你对关系章法的执念，藏着对无序失控的恐惧。模糊的界限、反复的态度、没说清的期待，在你眼里都是隐患。如果对方凭情绪做事、回避沟通，你会格外孤独 —— 像独自驾着没罗盘的船，既要稳住方向，又要拉扯对方节奏，没人一起扛理顺关系的责任。\n\n你真正想要的是双向协作：不用你单方面提要求，而是对方愿意主动对齐目标、一起沟通。你渴望的伙伴，能看懂你想聊清楚背后的不安，和你一起为稳定付出。你要的从不是掌控权，而是我们始终站在同一边的笃定。" },
      { t: "你的光：天赋优势", c: "1. 清晰的关系梳理力\n你总能一眼看穿矛盾的关键，不会让误会越积越深。无论是界限划分还是相处节奏，你都擅长把模糊的事说清楚，推动双方达成共识，让关系在明确的框架里稳稳往前走。\n\n2. 务实的问题突破力\n面对关系里的卡点，你从不会拖着或逃避。你行动力强，更愿意主动想办法、做调整。这份不推活、敢担当的态度，让关系总带着 “往前推进” 的方向感。\n\n3. 靠谱的关系托底力\n和你在一起，对方会觉得特别踏实。你不会让感情停留在 “凑活过” 的状态，会主动规划未来、协调矛盾。有你在，对方不用慌着找方向，因为你已经把 “一起走下去” 的底气铺好了。" },
      { t: "你的影：隐性挑战", c: "1. 对无序的极致焦虑\n一旦关系脱离预设的轨道 —— 比如对方做事没计划、态度反复无常，你会比常人更容易陷入慌乱。这种失控感会让你本能地想 “抓得更紧”，试图把关系拉回自己能掌控的状态。\n\n2. 独自掌舵的疲惫感\n你习惯了做关系里 “把舵的人”，默默扛起梳理节奏、解决问题、规划方向的责任。久而久之，身心俱疲却很难放手，总担心自己一松劲，这段关系就会乱成一团。\n\n3. 同步期待带来的压力\n你对自己要求严格，也会不自觉地期待对方能跟上。当对方理解不了你的想法时，你容易感到失望，却忘了每个人都有自己的节奏，不是所有人都能和你保持同频。" },
      { t: "给爱你的TA", isForPartner: true, c: "1. TA 不是想控制你，而是怕关系乱了阵脚\n当 TA 主动说想聊聊这件事、要不要把话说开，不是想挑刺吵架，只是想和你一起把关系捋顺，拉回彼此都安心的状态。\n\n2. TA 要的是一起扛的合作感\n你可以有自己的想法，不用事事顺着 TA，但请坦诚说出来。长期什么都不说、一味顺着，只会让 TA 觉得自己在独自扛下所有关系里的事。\n\n3. 偶尔提醒 TA：先不急解决问题，单纯陪陪我就好\nTA 面对矛盾的本能是先找答案，有时会忽略情绪。如果你明确说“我现在不想聊解决方案，就想被你抱着”，TA 其实愿意放慢脚步照顾你的感受。" },
      { t: "深度溯源", c: "你对掌控感的执念，往往源于童年无序环境下的生存本能。或许小时候环境里缺乏清晰规则，遇事没人定调，那种“没人牵头就会乱成一团”的不安刻在了你心里。你被迫学会了自己站出来建立秩序，主动管节奏、定方向。不是你想当“小大人”，而是只有把局面抓在手里，才能躲开那种慌慌张张的不安。" },
      { t: "自我重塑", c: "1. 接纳适度失控，关系不必事事精准\n关系不是精密仪器。偶尔偏离预期不是出错，一点小意外反而能让感情更有弹性。给关系一点缓冲的余地，也给自己松松紧绷的神经。\n\n2. 放下全能责任，学会把担子分出去\n你不是关系里唯一的责任人。当你又想包揽所有事时，试着停一停，把部分责任交出去：“这件事不如你来主导，我配合就好。”\n\n3. 允许自己不懂事\n你不用永远做那个最清醒的人。累的时候直接说“我现在没力气想那么多”。暴露脆弱不是软弱，而是敢对自己诚实——你也需要被照顾。" },
      { t: "祝福", c: "愿你遇见一个能和你并肩扛事、一起决策的人，不用再让你独自做那个 “负责全局的大人”。你们可以一起定方向，也可以一起接受偶尔的失控；他会尊重你的清醒，也会接住你偶尔的脆弱。\n\n更愿你慢慢学会，掌控感不是安全感的唯一来源。你可以保留自己的清醒和判断力，也能放心地说这次我想被带一带。" }
    ]
  },
  4: {
    title: "被偏爱",
    keyword: "独特的例外",
    quote: "你要永远为你驯服的东西负责。",
    tags: ["#专属感", "#深情专注", "#情感浓度"],
    summary: "你的安全感扎根于“例外感”。你不在意他对别人好，但如果在你这里没有“特殊待遇”，你的情绪会瞬间紧绷。",
    sections: [
      { t: "你的亲密底色", c: "在亲密关系里，你最核心的需求是“例外感” —— 哪怕他对全世界都好，对你也得再好那么一点点。你会不自觉地在心里做对比：他对别人是客套疏离，对我是不是多了份耐心？你不是爱计较，只是需要从这些差别里，抓住那份 “我在你心里有独属位置” 的笃定。\n\n你愿意毫无保留地付出，但有个隐形前提 —— 你的爱意需要被 “特殊对待” 来回应。如果有一天，你发现他的温柔开始平均分配，你的情绪会瞬间绷紧。你怕的不是他对别人好，而是他对所有人都一样好，怕自己的深情最后只换来 “可有可无” 的待遇。\n\n你比谁都敏感，哪怕是一丝一毫的冷淡或疏忽，都能触动你的神经。这份敏锐让你爱得深沉，能把关系经营得细腻动人；但也让你格外脆弱，因为你所有的安全感，都扎根在 “我是你独一份的偏爱” 这个锚点上。" },
      { t: "你的光：天赋优势", c: "1. 深情且坚定的专注度\n一旦认定一个人，你会全身心投入，给出稳定又纯粹的爱意。你的爱不是泛泛的好，而是带着 “只对你” 的专属感，让对方能清晰感受到被珍视。\n\n2. 细腻入微的洞察力\n你能捕捉到别人忽略的细节 —— 记得他随口提的喜好、察觉他没说出口的情绪。这种 “被真正看见” 的体贴，让关系充满温度。\n\n3. 用心经营独特联结\n你擅长创造属于你们的专属记忆，可能是只有彼此懂的暗号，可能是优先考虑对方的习惯，这些 “别人没有” 的小细节，让关系变得格外深刻动人。" },
      { t: "你的影：隐性挑战", c: "1. 对差别对待的极致敏感\n对方对别人多一份耐心、多一句关心，你心里的天平就会倾斜。不是小气，是怕自己的 “特别” 被稀释，怕那份独有的偏爱慢慢消失。\n\n2. 陷入过度求证的内耗\n你会忍不住反复琢磨他的言行，哪怕是一句随口的话，都要从中寻找 “他到底有没有更在乎我” 的答案，越想越焦虑。\n\n3. 怕落空的防御性退缩\n一旦感觉自己不再特别，你会下意识收回深情。不是冷漠，是怕自己毫无保留地付出，最后只换来和别人一样的待遇，这份防御背后，是藏不住的不安。" },
      { t: "给爱你的TA", isForPartner: true, c: "1. TA 要的从不是更多，而是独一份\n不用送昂贵的礼物，但若你记得她随口提的喜好，或是在众人面前下意识护着她，这种只对她有的用心，才是最让她安心的偏爱。\n\n2. 别用你想太多否定她的敏感\n当 TA 因为小事委屈时，最伤人的是你一句小题大做。先抱抱她说“我懂你在意的是我没对你特别对待”，比讲道理管用得多。\n\n3. 主动表达偏爱是刚需\n偶尔说一句“你在我心里和别人不一样”，或是在选择时优先考虑 TA 的感受，这些直白的信号，能帮她赶走所有 “我是不是可替代” 的不安。" },
      { t: "深度溯源", c: "这份对独一份的渴求，往往源于那些自己的在意没被优先回应的成长时刻。小时候，或许你总处在关注被分摊的环境里，需求常常排在后面。你慢慢发现，只有当自己得到特殊对待时，才能真切感受到“我是重要的”。这份源于早年的心理缺口，让你在亲密关系中格外执着于差别对待，想补上童年没被坚定选择的遗憾。" },
      { t: "自我重塑", c: "1. 接纳敏感，它不是缺点\n不用骂自己小心眼。当你因为小事难过时，先对自己说一句“我知道你只是怕没被偏爱”。这份情绪没有错，不用逼自己压抑。\n\n2. 自己先给足自己独一份的宠爱\n别总等着别人来证明你的特别。想吃的东西自己去尝，想做的事自己去做。你值得被偏爱，这份偏爱不用依赖任何人，从自己开始就足够。\n\n3. 学会直白表达需求\n不用让对方费力猜。直接说：“和别人聊天时，希望你能先回我消息”。清晰的需求才能换来精准的回应，直白表达从来都不是自私，是对自己的负责。" },
      { t: "祝福", c: "愿你遇见明目张胆的偏爱，有人把你放在心尖上，让你清清楚楚感受到，自己就是那个不可替代的例外。\n\n更愿你自带自我偏爱的底气，不用依赖别人的特殊对待，也能笃定自己值得所有美好 —— 往后余生，被爱眷顾，更被自己偏爱。" }
    ]
  },
  5: {
    title: "精神共鸣",
    keyword: "灵魂的同频者",
    quote: "我们相遇在精神的旷野，无需言语便已相通。",
    tags: ["#灵魂契合", "#深度交流", "#思想共振"],
    summary: "你渴求的是灵魂层面的同频共振。日常的寒暄无法满足你，你追求的是“懂”。",
    sections: [
      { t: "你的亲密底色", c: "在亲密关系里，你最核心的需求从不是占有或依赖，而是一种灵魂层面的同频共振 —— 思想被看见、观点被呼应。对别人来说，爱可能是柴米油盐，但对你而言，亲密的根基永远是思维契合：能一起穿透表象，探讨那些看似无用却关乎自我的命题，能在眼神里读懂 “无需多言” 的默契。\n\n日常寒暄固然温暖，却替代不了 “你一句话戳中我未说出口的心事” 的碰撞。这种共鸣不是刻意追求深奥，而是对 “有质量的连接” 的本能渴求 —— 你怕的不是没有话题，而是话题永远停留在浅层，怕两个人明明靠得很近，灵魂却隔着无法逾越的距离。\n\n你对浅层关系有着近乎本能的疏离感。一旦遇到那个能在思维深处与你同频的人 —— 能听懂潜台词，能接住奇思妙想，能一起保持好奇，你便会卸下所有防备。因为你知道，这样的灵魂相遇，才是你真正渴望的亲密。" },
      { t: "你的光：天赋优势", c: "1. 思想共振的活力感\n你带给对方的不只是爱情，更是共同成长的可能 —— 一起拓宽认知边界、探索世界，让关系始终保持向上的生命力。\n\n2. 深层共情的理解力\n你懂得 “倾听” 的真正意义，不只是听表面的话，更能读懂背后的想法与情绪，让对方真切感受到 “被完全懂了” 的安心。\n\n3. 持续焕新的新鲜感\n和你在一起从不会陷入枯燥重复，思维的碰撞、观点的交流，总能为关系注入新灵感，永远有聊不完的话题。" },
      { t: "你的影：隐性挑战", c: "1. 浅层关系的低耐受度\n如果一段关系长期只停留在 “吃了没”“在干嘛” 的琐事寒暄，没有深入的思想交流，你会慢慢失去存在感，想要抽离。\n\n2. 将 “不理解” 等同于 “不在意”\n对方未必不爱你，只是没能跟上你的思维深度，但这种 “聊不到一块” 的距离，在你心里会被放大成 “你不懂我，也不在乎我”。\n\n3. 忽略日常幸福的价值\n有时候你太执着于灵魂契合，反而会忽视相处中的小温暖 —— 比如默默的陪伴、笨拙的关心，这些普通的幸福其实也能滋养关系。" },
      { t: "给爱你的TA", isForPartner: true, c: "1. TA 要的不只是日常报备，更是心里的真实回响\n柴米油盐固然重要，但如果长期只停留在表面寒暄，TA 会觉得灵魂没被接住。愿意把心里的困惑、思考甚至价值观告诉 TA，才是最踏实的靠近。\n\n2. 当 TA 聊起好似“无用”的话题，是悄悄递来的靠近信号\n那些抽象的探讨，本质上是 TA 想看看：你愿不愿意放下琐碎，在精神上陪 TA 站一会儿，一起触碰内心更深的地方。\n\n3. 你不用懂多少深奥理论，但请别关闭探索欲\nTA 没要求你成为思想家，只是希望你别用 “想那么多干嘛” 敷衍。哪怕只是认真听完，再坦诚分享你的真实感受，对 TA 来说都是莫大的珍惜。" },
      { t: "深度溯源", c: "你对精神共鸣的执着，往往源于童年“想太多却没人懂”的体验。小时候你可能总比同龄人多想一层，试着说出口却很少被真正倾听。久而久之，你把思考藏了起来，但心底里埋下了执拗的期待：希望有个人能看穿你的“与众不同”，能跟上你的思路。这份童年里未被满足的渴望，变成了你对亲密关系的核心期待——想要一份“不用费力解释，你就懂我”的笃定。" },
      { t: "自我重塑", c: "1. 接纳你的深度需求，它从不是缺点\n不用怪自己“想太多”。你天生自带对深度连接的敏感，这份对意义的渴望是你独特的珍贵特质。有人懂是锦上添花，暂时没人懂，也不代表你不好。\n\n2. 不把所有期待，都压在一个人身上\n灵魂的需求可以多元安放：伴侣陪你逛超市聊家常，而深度的思考可以分给志同道合的朋友、书籍或创作。不必苛求一个人满足你所有，反而能减少拉扯。\n\n3. 学会在普通日子里，发现藏着的连接\n多留意日常相处里的小默契：一起吐槽堵车、看电影时的感慨。这些看似浅层的互动，其实都在悄悄拉近距离。平淡里的心意，也值得被珍惜。" },
      { t: "祝福", c: "愿你这一生，既能遇见共享柴米油盐的人，也能遇见共赴精神旷野的伙伴。愿有人愿意认真听你说完所有奇思妙想，和你一起对世界保持好奇。也愿你在无人完全懂你的时刻，依然坚信：你的思考、你的独特，本身就是最珍贵的礼物。" }
    ]
  },
  6: {
    title: "自由感",
    keyword: "自在的并行者",
    quote: "我爱你，却不愿用爱束缚你。",
    tags: ["#独立空间", "#拒绝捆绑", "#自我完整"],
    summary: "你的核心需求是“在爱里守住自我”。你愿意亲密，但必须保留完全属于自己的空间。",
    sections: [
      { t: "你的亲密底色", c: "在亲密关系里，你最核心的需求从不是占有或依赖，而是 “在爱里守住自我” 的自由 —— 靠近不难，难的是不用时刻黏在一起、不用事事报备、不用为了迎合对方丢掉自己的节奏。\n\n你愿意真心投入，但必须保留一块完全属于自己的空间。只要这份空间被尊重，你的爱就会自然流淌；可一旦被过度关注、追问，或是被要求 “必须怎样”，你的本能反应就是退一步 —— 不是害怕亲密，而是怕在关系里慢慢弄丢自己，怕那些 “为你好” 的期待变成牢笼。\n\n对别人来说，亲密可能是 “时刻在线” 的陪伴，但对你而言，好的关系是 “我需要时你在，我想独处时你不扰”：我们可以并肩往前走，也可以各自有自己的轨道；不用为了对方改变节奏。这份 “不吞没、不束缚” 的自在，才是你最踏实的亲密。" },
      { t: "你的光：天赋优势", c: "1. 让人舒展的松弛感\n你从不会要求对方 “秒回消息”“事事报备”，让对方觉得和你在一起不用紧绷，能安心做自己，没有被控制的压抑。\n\n2. 清晰坚定的边界感\n你懂得尊重自己的空间，也从不越界干涉别人的选择，不会用 “爱” 为名绑架对方的生活，这种分寸感让关系始终保持舒展。\n\n3. 自我负责的情绪力\n你很少把所有情绪都丢给对方消化，遇到压力时更习惯自己先梳理，不会过度依赖对方的安慰，不给关系添上沉重的情绪负担。" },
      { t: "你的影：隐性挑战", c: "1. 对 “过度靠近” 的本能抗拒\n只要对方表现出过度依赖、频繁追问，哪怕没有恶意，你也会下意识想后退，容易让对方误以为你 “不够爱”。\n\n2. 习惯 “独自消化” 的封闭性\n你太擅长自己处理情绪，常常忘了对方也希望参与你的世界 —— 哪怕只是听你吐槽，你也会下意识说 “没事”，让对方觉得自己走不进你的心里。\n\n3. “清淡表达” 的误解风险\n你在意一个人时表达方式也不会太浓烈，不会频繁说我爱你。这种清淡的态度，很容易让对方感受不到你的在意，陷入猜疑。" },
      { t: "给爱你的TA", isForPartner: true, c: "1. 我需要独处，从不是不爱你\n有时候我会暂时抽离去做自己的事，不是想冷落你，是独处的安静能让我沉淀心绪，调整好了就会带者更踏实的心意回到你身边。\n\n2. 别用时刻在线检验我的爱\n秒回消息、频繁报备、每天黏在一起，这些都不是我爱你的证明。不用总用“为什么不找我”考验我，那只会让我本能地后退。\n\n3. 当我主动告诉你我的安排，其实是在把你放进生活里\n比如今天想一个人待着、最近在忙什么，这都不是推开你，而是我愿意让你知道我的状态。如果你能回应一句“好，我等你”，我会更安心。" },
      { t: "深度溯源", c: "你对自由感的执着，源于早年成长中刻进心底的本能渴望。小时候你可能总被“听话”的期待包裹，想法被否定、生活被管束。慢慢你懂了，只有守住自己的空间和节奏，才不会被吞没。这份自我保护，让你在亲密关系里对“被绑住”的感觉格外敏锐。你拼命想要的自由，说到底，不过是想被好好尊重——允许你按自己的节奏活。" },
      { t: "自我重塑", c: "1. 接纳你的边界需求，它从不是冷漠\n不用因为不爱黏人就怪自己。你对自由和边界的珍视，是保护真实自我的重要特质。真正爱你的人，会接纳你所有的样子，包括你需要独处的时刻。\n\n2. 温柔划定边界，不用刻意推开\n不用等越界了才仓促后退，主动说清节奏：“我每天想留1小时做自己的事，这样能更专注地跟你相处”。清晰的边界是给彼此的安心约定。\n\n3. 试着适度敞开，不用一直硬扛\n不用追求完全透明，但可以偶尔说一句“这件事我有点乱，想听听你的想法”。适度的敞开不是失去自由，而是让对方知道：你不是不想靠近，只是需要时间整理自己。" },
      { t: "祝福", c: "愿你始终保有做自己的勇气和节奏，不用为了爱妥协，不用为了自由假装冷漠。愿你遇见这样的人：他懂你对自由的渴求，不会用 “爱” 捆绑你；你们是并行的光，各自有自己的轨道，却能在彼此需要时相互照亮。" }
    ]
  },
  7: {
    title: "安全距离",
    keyword: "审慎的慢热者",
    quote: "待人如执烛，太近灼手，太远暗生。",
    tags: ["#慢热审慎", "#宁缺毋滥", "#长情"],
    summary: "你的靠近是“安全第一”。你不是冷淡，只是自带“安全缓冲带”，必须反复确认无刺痛才敢前行。",
    sections: [
      { t: "你的亲密底色", c: "在亲密关系里，你最核心的需求从不是轰轰烈烈的奔赴，而是 “安全第一” 的踏实靠近 —— 你从不是冷淡，也不是慢热，只是心里自带一层 “安全缓冲带”，像洗手前慢慢试探水温，先确认没有刺痛，才敢再往前挪一步。\n\n你的亲密节奏里藏着独有的审慎：先悄悄观察、反复确认，直到笃定 “这个人值得托付”，才敢真正卸下防备。任何猛扑过来的热情、急着拉你进入深度关系，都会让你下意识启动自我保护。这不是推开，是怕步子迈太急反而摔得疼；是怕那些 “来得快” 的亲密，会像潮水一样突然退去。\n\n你需要的，是一个能读懂 “你不是不上心，只是需要时间” 的人。你对关系的态度从来都是 “宁缺毋滥” —— 确定前有多审慎，确定后就有多坚定。一旦认定彼此，便会拿出骨子里的稳定与长情。" },
      { t: "你的光：天赋优势", c: "1. 慎重长情的定心丸\n不轻易开启关系，一旦选择便全心投入、坚定不摇，从不会敷衍应付，是关系里最让人安心的 “定海神针”，能稳稳托住彼此的期待。\n\n2. 亲疏有度的平衡感\n既不会黏腻到让人窒息，也不会疏远到让人不安，总能精准拿捏 “刚刚好” 的距离，让彼此在亲密中保留独立，活得舒展自在。\n\n3. 克制稳健的情绪力\n从不会把负面情绪随意甩给对方，也不会在冲动下做出伤害关系的决定，总能用理性稳住节奏，用审慎化解矛盾。" },
      { t: "你的影：隐性挑战", c: "1. 节奏错位的孤独感\n你的 “慢试探” 总与他人的 “快节奏” 错位，很少有人能读懂你 “需要时间确认” 的谨慎。你满心认真对待，却总被误解为 “不上心”，最后只剩 “不被读懂” 的孤单。\n\n2. 被催后的防御性退缩\n只要对方急于推进关系、用力催促，哪怕没有恶意，你也会下意识后退自保。可对方往往把这份退缩当成 “没兴趣”，误会层层叠加。\n\n3. 观察期的无限内耗\n总想着 “再确认一次”，越观察越不敢迈出关键一步。既怕草率选择会受伤，又怕过度谨慎会错过，陷入反复纠结的内耗。" },
      { t: "给爱你的TA", isForPartner: true, c: "1. 我的慢不是没感觉，是怕真心错付\n如果你催得太急，只会让我本能后退。你看到的“慢半拍”，其实是我在认真掂量。我不想草率开始，只想和你稳稳走到最后。\n\n2. 我很难在带着情绪的氛围里说心里话\n如果你用指责、讽刺的方式逼我，我只会把心关上。如果你能放下评判，不着急反驳，哪怕不认同也愿意听我说完，我才会慢慢卸下防备。\n\n3. 一直都靠谱的踏实感，比一次性盛大更重要\n对我来说，一直没变的态度、说到做到的承诺，远比轰轰烈烈的示爱更有分量。只要让我感受到“你一直都在”，我才敢真正靠近。" },
      { t: "深度溯源", c: "你对安全距离的执着，源于早年一次次“靠近=受伤”的经历。小时候你的真心或许被嘲笑、信任被辜负，或者在情绪失控的大人面前战战兢兢。一次次失望后，你摸清了规律：不轻易伸手就不会被推开。这份为了保护自己而养成的习惯，成了刻在骨子里的自我保护。你所有的“慢”，不过是想确认：这个人，真的不会伤害我吗？" },
      { t: "自我重塑", c: "1. 接纳自己的节奏，不用自责太冷\n不用因为谨慎就苛责自己。你的慢是对关系的认真，从来不是缺点。真正适合你的人，自然会愿意等你准备好。\n\n2. 试着小步敞开心扉\n不用逼自己立刻全盘托出。从分享细微的情绪开始，选一个你觉得安全的小片段试着说说。一点点打开自己，既没压力，也能让对方读懂你的心意。\n\n3. 直白说出你的需要\n温柔地把需求说清楚：“我需要一点时间确认，希望你能多等等”。清晰的表达能减少误会，让对方知道该怎么靠近你。" },
      { t: "祝福", c: "愿你遇见这样一个人：不催你交卷，不逼你前行，愿意陪着你慢慢来。他能读懂你慢热背后的赤诚，看穿你谨慎底下的深情。\n\n更愿你往后的亲密里，不再被贴冷漠的标签。总有人懂你的分寸，尊重你的节奏。也愿你有一天，能在真正安全的关系里，轻轻告诉自己：这次，我可以试着比从前再靠近那么一点点。" }
    ]
  },
  8: {
    title: "秩序感",
    keyword: "清醒的共建者",
    quote: "好的关系，是一起把日子过成有章法的温柔。",
    tags: ["#规则共识", "#拒绝内耗", "#未来规划"],
    summary: "你追求的是“有章法的温柔”。你认定长期关系的根基是清晰的边界和明确的共识。",
    sections: [
      { t: "你的亲密底色", c: "在亲密关系里，你是主动和对方搭建关系框架的共建者，核心需求从不是模糊的浪漫悸动，而是两人共同打磨的秩序感 —— 清晰的边界不越界，明确的期待不猜度，可落地的沟通不内耗，这些才是你敢放心交付真心的底气。\n\n你打心底不信随缘式相处能走得远，认定长期关系的根基必须扎在坦诚沟通、明确共识的土壤里。这不是理性过度的较真，而是怕够了混乱带来的消耗：怕猜来猜去的误会拉扯，怕悬而未决的矛盾堆积。所以你会下意识想要对齐彼此的位置、节奏和未来方向。\n\n当关系里出现模糊态度、不愿沟通的逃避，你会比谁都先感到焦虑。你需要的不是听话照做的伴侣，而是愿意一起共建规则的伙伴。对你来说，亲密不是情绪的随意流动，而是两人并肩把日子过稳的笃定。" },
      { t: "你的光：天赋优势", c: "1. 化繁为简的秩序力\n擅长把混乱的相处捋顺，将模糊的边界、零散的期待转化为清晰共识，为关系避开无效内耗，少走很多弯路。\n\n2. 主动破局的沟通力\n遇事从不会逃避冷战，反而主动牵头沟通，愿意和对方一起拆解问题、寻找答案，不把矛盾留到隔夜。\n\n3. 长远共建的规划力\n自带长远视角，不沉溺当下甜蜜，更会从现实出发和对方共建未来规划，让关系在踏实步履中稳步扎根。" },
      { t: "你的影：隐性挑战", c: "1. 对模糊状态零容忍\n只要对方态度暧昧、回避沟通，或是用顺其自然敷衍，心里就会立刻陷入焦虑，难以踏实下来。\n\n2. 急于解决却忽略情绪缓冲\n习惯遇事立刻推进解决，却忘了亲密关系需要情绪消化的空间，有时候对方要的是安慰，而非马上被梳理成条理。\n\n3. 对回避沟通者易失耐心\n你的要求其实很简单，只是希望对方愿意坐下来坦诚聊聊，但这在很多关系里难实现，久而久之便会因反复消耗失去耐心。" },
      { t: "给爱你的TA", isForPartner: true, c: "1. 坦诚本身就是最踏实的爱\n我不是故意较真，只是想和你少些内耗。愿意和我一起商量相处规则，对我来说就是被尊重、被当成平等伙伴的最好证明。\n\n2. 长时间的模糊状态会耗光我的安全感\n如果你总用“顺其自然”回避聊关系本身，我只会越来越焦虑。我不想在混沌里消耗，只想拥有一段清晰笃定的关系。\n\n3. 当我提议聊聊，请一定认真对待\n我不是要审判谁，只是想把误会捋清。你如果愿意和我一起面对，而不是逃避冷战，我对这段关系的信心会成倍增加。" },
      { t: "深度溯源", c: "小时候的你，最怕没个准数的慌。或许经历过承诺落空、规矩朝令夕改、遇事没人牵头的混乱。你慢慢发现，只有自己给自己找章法才踏实。这份秩序感，是你捂热不安的方式，是你在混乱中亲手抓住的救命稻草。长大后你把这份需求带进亲密关系，想要的从不是冷冰冰的条款，而是“有人和你一起稳住日子”的安心。" },
      { t: "自我重塑", c: "1. 接纳自己的秩序需求\n不用因为凡事想捋清楚就苛责自己。你对秩序的渴求，是保护自己也守护关系的珍贵能力，一点都不过分。\n\n2. 分清问题和情绪，给彼此缓冲\n下次遇到矛盾，别急着立刻推进解决。先问问自己：对方现在需要的是方案还是理解？试着先接住对方的情绪，再聊怎么处理。\n\n3. 允许关系有温柔的留白\n只要能看到对方的诚意，感受到他在努力靠近，偶尔慢一点、留白久一点，也没关系。不强求所有事立刻有结果。" },
      { t: "祝福", c: "愿你遇见不回避问题、不敷衍沟通的同行者。愿意和你一起把话说透、把日子捋顺。你的清晰、原则与不将就的坚持，从来都是珍贵的礼物。有章法的相处少内耗，这份踏实的温暖，是你最长久的幸福。" }
    ]
  }
};

// 完整题库 (48题)
const QUESTIONS = [
  // Part 1: 现实切片
  { id: 1, text: "周末下午，伴侣突然失联了3个小时，发消息也没回。那一刻，你最真实的反应是？", opts: [{t: "下意识地去翻聊天记录，看是不是我说错话了？这种未知最折磨人。", v: 1}, {t: "挺好的，刚好没人管我。我可以专心做自己的事，不用一直切出去回消息。", v: 6}, {t: "第一反应是推测原因，准备等联系上后，哪怕不吵架，也要问清楚去向，防止下次再这样。", v: 3}, {t: "心里会有点堵得慌。也不是多大事，就是觉得如果他够在意我，怎么舍得让我空等这么久？", v: 4}] },
  { id: 2, text: "伴侣最近工作压力极大，回到家情绪很低落，坐在沙发上一言不发。此时你心里最真实的念头是？", opts: [{t: "看着挺心疼的。我不一定能帮上忙，但至少给他倒杯水、切点水果，让他知道身边有人照顾着。", v: 2}, {t: "他现在应该很烦，不想说话。那我就识趣点，躲远点玩手机，别去撞枪口，等他缓过来了再说。", v: 7}, {t: "这种死气沉沉的沉默让我很难受。我还是希望能聊聊，哪怕只说几句，让我知道他脑子里到底在想什么也好。", v: 5}, {t: "我比较在意接下来的安排：今晚是就在家吃还是出去？既然心情不好，原本的计划还作数吗？", v: 8}] },
  { id: 3, text: "因为一件琐事发生了激烈的争吵，甚至有些冷场。你心里那个过不去的点主要是？", opts: [{t: "吵架可以，但能不能别用那种冷冰冰的态度对我？那种好像随时要放弃我的感觉，比吵架本身更让我害怕。", v: 1}, {t: "情绪发泄完了吗？完了我们就复盘一下。到底谁对了谁错了，以后这种情况按谁的来？别稀里糊涂就过去了。", v: 8}, {t: "看他气得脸色发白或者不说话的样子，我突然就心软了。输赢不重要，我甚至想先低头哄哄他。", v: 2}, {t: "这种无法沟通的局面让我很烦躁。如果不立刻把问题解决掉、翻篇，我就没法继续安心做别的事。", v: 3}] },
  { id: 4, text: "你冷不丁冒出一个有点奇怪的脑洞，随口讲给伴侣听。此时你最期待/最真实的反应是？", opts: [{t: "哪怕他没听懂，但只要他愿意放下手机、转过身来认真听我说完这些废话，我就觉得很满足，因为他在乎我。", v: 4}, {t: "他能瞬间接住这个梗，甚至还能顺着我的逻辑延伸出新的观点。那一刻我会觉得“天哪，这个世界上只有你懂我”。", v: 5}, {t: "我不强求他懂，更别为了迎合我而硬聊。我最舒服的状态是：我说我的，你听你的，哪怕观点完全不同也没关系，不必非要强行同步。", v: 6}, {t: "其实我通常只敢说一半。对于那些特别真实、特别私人的怪想法，我还是习惯自己留着，怕说出来对方接不住，反而尴尬。", v: 7}] },
  { id: 5, text: "伴侣想看你的手机，或者询问你过去的详细情感经历。你的本能反应是？", opts: [{t: "哪怕没秘密，我也很反感。这是我的隐私，每个人都该有自己的小世界，这种被审视的感觉让我很不舒服。", v: 6}, {t: "随便看。甚至如果你看了能更安心、更信任我，那我求之不得。我不希望我们之间有任何猜疑。", v: 1}, {t: "看可以，但要公平。如果我也能看你的，或者我们也交换秘密，那就没问题。规则对等就行。", v: 8}, {t: "看可以，但我不想被误解。那些都是过去的事了，我不希望你只盯着几个名字或事件，就片面地定义现在的我。", v: 5}] },
  { id: 6, text: "伴侣偶尔有些迷糊，犯了个不大不小的错（比如买错了东西、记错了时间）。你下意识的第一反应通常是？", opts: [{t: "下意识地去兜底。 看他搞砸了，我第一反应不是生气，而是直接上手帮他善后。", v: 2}, {t: "觉得被忽视了。 第一反应是：“你是不是没把我的事放心上？”如果你足够在意我，就不该犯这种错。", v: 4}, {t: "复盘原因。 我会本能地想知道哪个环节出了问题。这种不在计划内的失误让我很难受，我想确保下次别再发生。", v: 3}, {t: "无所谓。 “谁还没个犯错的时候，多大点事。” 我也不希望如果我犯错了对方揪着不放。大家都轻松点最好。", v: 7}] },
  { id: 7, text: "谈到“未来”这个话题时，什么情况最让你感到不安？", opts: [{t: "没有计划，没有具体打算，就说“顺其自然”。这种没规划的日子让我很没底。", v: 8}, {t: "他的态度不坚定。如果他表现出一丝犹豫，或者说“以后的事以后再说”，我就会怀疑他是不是没打算长久。", v: 1}, {t: "一想到未来几十年都要和一个人绑死，还要面对柴米油盐的琐碎，我就本能地想逃，怕自己会慢慢枯萎。", v: 6}, {t: "我怕未来大家都很忙，各过各的。让我觉得我们不是爱人，而是正在变成两个合租的陌生人。", v: 2}] },
  { id: 8, text: "当你自己情绪崩溃、非常脆弱的时候，你最希望对方做什么？", opts: [{t: "别一直问“怎么了”、“别哭了”。就当没看见，让我自己躲一会儿，等我好了再出来。", v: 7}, {t: "不需要讲道理，也不需要给建议。只要抱着我，让我感觉“这一刻你也一样难过”，我就被治愈了。", v: 5}, {t: "帮我分析一下现在的烂摊子该怎么收场。与其哄我，不如帮我一起把那个搞崩我的问题解决掉。", v: 3}, {t: "就算我无理取闹，也请先站在我这边。别跟我讲客观公正，这时候我只需要偏袒。", v: 4}] },
  { id: 9, text: "到了纪念日或生日，如果伴侣准备的礼物（或安排）让你觉得有点失望，那个失望的点通常是？", opts: [{t: "觉得不够用心。 并不是要多贵，而是这东西随便谁都能买到，完全看不出我是那个被特殊对待的人。", v: 4}, {t: "觉得没意义。 他送的东西跟我完全不搭界，说明他根本不了解我最近在关注什么，也不懂我的喜好。", v: 5}, {t: "觉得不实用或浪费。 这种华而不实的东西，破坏了我们的开销计划，还不如买点家里正缺的实用的。", v: 8}, {t: "觉得不平衡。 我总是习惯把你的喜好记在备忘录里，但你对我却一无所知。我难过你没有给我同等的在意。", v: 2}] },
  { id: 10, text: "带伴侣去参加你的朋友聚会。整个过程中，你最舒服的状态是？", opts: [{t: "“连体婴”模式。 我不希望把他晾在一边。哪怕跟别人聊天，我也希望我们是站在一起的，或者眼神时不时能对上。", v: 1}, {t: "“得体”模式。 我比较在意他能不能融入。希望他表现大方、说话得体，别冷场也别出格。", v: 3}, {t: "“放养”模式。 最好是各玩各的。 我聊我的天，他找他的乐子，不用我时刻照顾他的情绪。", v: 6}, {t: "“低调”模式。 正常社交就好，千万别让我们成为全场的焦点。", v: 7}] },
  { id: 11, text: "两个人一起出去旅行，最容易让你心里炸毛的瞬间是？", opts: [{t: "由于对方磨蹭或出错，导致赶不上车/景点关门。 这种因为人为失误搞砸计划的感觉，会让我瞬间暴躁。", v: 3}, {t: "行程变来变去。 一会儿要去这一会儿要去那，完全没有章法。我需要知道今天到底要干嘛，而不是在街上瞎晃。", v: 8}, {t: "被行程表催着走。 出来玩就是为了放松，如果非要打卡、几点必须起床，那这就不是旅行，是军训。", v: 6}, {t: "同路不同频。我想跟他感叹一下风景的震撼，他却一脸漠然，或者只关心等会儿吃什么。这比一个人旅行更寂寞。", v: 5}] },
  { id: 12, text: "同居或长相处时，伴侣有一些让你看不惯的生活习惯（比如乱丢袜子、熬夜）。你通常会怎么想？", opts: [{t: "“没有规矩。” 家里必须有基本的整洁标准，如果大家都随心所欲，这个家就乱套了，我没法忍受混乱的环境。", v: 8}, {t: "“他不重视我。” 我都说过好几次了让他改，他还是这样。是不是我说的话他根本没放在心上？", v: 1}, {t: "“别管我就行。” 只要他不强迫我也跟着他乱，或者别反过来管我，我懒得因为这点破事吵架。", v: 6}, {t: "“还是我来吧。” 骂归骂，最后还是我默默帮他收拾了。", v: 2}] },
  { id: 13, text: "伴侣无意中提起了一个优秀的异性朋友，言语间带着欣赏。你心里的第一反应是？", opts: [{t: "酸溜溜的。 哪怕知道没事，心里也膈应：你为什么要当着我的面夸别人？难道我不够好吗？", v: 4}, {t: "警铃大作。 我会开始对比：那个人是不是比我更适合他？我是不是有被替代的风险？这种危机感让我很不安。", v: 1}, {t: "想搞清楚界限。 我不反感交友，但我需要确认他们现在到底是什么关系？有没有越界？这一切是否在可控范围内？", v: 3}, {t: "无所谓、装傻。 只要别影响我就行。我不太想深究他们的过去，也不想表现得像个嫉妒狂，太难看了。", v: 7}] },
  { id: 14, text: "在一起久了，关系进入一种“左手摸右手”的平淡模式，每天除了吃饭睡觉没别的话题。你会觉得？", opts: [{t: "这是一种慢性死亡。 如果没有了思想交流，没有了火花，这段关系只剩下一个空壳，哪怕日子安稳，也让我觉得索然无味。", v: 5}, {t: "有点失落。 以前他总是围着我转，现在他回家就玩手机，好像我这个人在不在家对他来说都没差别了。", v: 2}, {t: "求之不得。 终于到了这一步！不用每天费劲维系激情，各干各的事，这种空气般的相处才是最舒服的。", v: 6}, {t: "这很正常。 激情总会褪去，现在这种稳定的、可预测的生活节奏，反而让我觉得很踏实，日子就是这样过的。", v: 8}] },
  { id: 15, text: "你有一个非常痴迷的小爱好（比如拼模型、追星、某种运动），但伴侣完全不感兴趣。你希望他的态度是？", opts: [{t: "别干涉我。 这是我的自留地，请你也离远点。不需要你理解，只要别在我玩的时候在旁边指手画脚就行。", v: 7}, {t: "尊重我的投入。 我花在这个上面的时间、金钱是经过计算的，我有分寸。别总质疑我不务正业。", v: 3}, {t: "试着懂我一点。 你可以不玩，但如果你能明白为什么这个东西能打动我，我会很开心。", v: 5}, {t: "陪我一起玩。 哪怕你不喜欢，我也希望你能为了我试着参与一下。看着你陪我做我喜欢的事，我会觉得很幸福。", v: 4}] },
  { id: 16, text: "大吵一架终于和好了。为了让这页彻底翻过去，你最需要的一个“收尾动作”是？", opts: [{t: "反复确认。 我可能会忍不住再问几次：“你真的不生气了吗？”“我们真的没事了吗？”直到听到肯定的回答。", v: 1}, {t: "某种补偿行为。 比如给他做顿好吃的，或者对他格外好一点。", v: 2}, {t: "彻底不提。 既然和好了，就赶紧回归正常，把这尴尬的一页揭过去最好。", v: 7}, {t: "得到一个小惊喜。 不管谁对谁错，如果他能在这个时候给我买个小礼物或者带我吃顿好的就好了。", v: 4}] },
  // Part 2: 情绪暗涌
  { id: 17, text: "在一段关系里，最让你感到心慌、不踏实的那种时刻，其实是？", opts: [{t: "不知道下一秒会发生什么。 这种内心悬空的感觉最折磨人，我宁愿你直接判我死刑，也不要让我猜你到底还爱不爱我。", v: 1}, {t: "感觉透不过气。不管我走到哪、干什么，好像都有双眼睛盯着我，那种被严密包裹的窒息感，让我只想逃。", v: 6}, {t: "事情脱离了轨迹。明明说好的事突然变了，或者局面完全乱套了，这种无法把握方向的感觉让我非常焦躁。", v: 3}, {t: "像在演独角戏。 无论我表达什么，都像掉进了黑洞，没有任何反馈。这种两个人面对面、心却连不上的孤独感，比激烈的争吵更让我绝望。", v: 5}] },
  { id: 18, text: "当你在感情里觉得特别委屈时，脑海里那个挥之不去的念头是？", opts: [{t: "“好像我没什么价值。” 我做了这么多，你却觉得理所当然，甚至根本不需要。那种觉得自己很多余的感觉最伤人。", v: 2}, {t: "“我就知道会受伤。” 只要一靠近就会有风险，我刚才那一瞬间的脆弱被你无视了，这让我本能地想立刻缩回去。", v: 7}, {t: "“这不公平。” 为什么总是我在妥协？为什么规则对我不适用？这种不对等的付出让我觉得非常憋屈。", v: 8}, {t: "“原来我和别人没区别。” 我以为对你来说我是特别的，但刚才那个细节告诉我，我并没有被你放在那个例外的位置上。", v: 4}] },
  { id: 19, text: "你理想中最好的爱，给你的直接感觉应该是？", opts: [{t: "轻松。 没有压力，没有强制要求。我想粘你的时候就粘，想一个人待着你也觉得没问题，不用时刻紧绷着。", v: 6}, {t: "踏实。 不管发生什么，我都清楚地知道你不会走。那种心里有底、不用患得患失的感觉，最让我舒服。", v: 1}, {t: "默契。 是一种不用费劲解释的轻松。我可以把脑子里最真实、甚至最奇怪的想法直接抛给你，不用担心你接不住。", v: 5}, {t: "清晰。 我们知道未来去哪，也知道现在该干嘛。一切都在计划中稳步推进，这种井井有条的感觉最好。", v: 3}] },
  { id: 20, text: "当伴侣非常用力地黏着你、时刻都要和你在一起时，你的真实感受是？", opts: [{t: "很踏实。 这说明你真的很依赖我。我很享受这种“被你完全信任、完全依靠”的感觉，这证明了我在你生活里是不可替代的。", v: 2}, {t: "很想躲。太近了，这种高密度的亲密让我觉得不自在，甚至是种打扰。我需要一点时间回血，别逼太紧。", v: 7}, {t: "有点烦。 亲密可以，但要有分寸。如果连我的工作和正常生活节奏都被打乱了，我会觉得你很不懂事。", v: 8}, {t: "很受用。 嘴上可能说“烦死了”，但心里其实暗爽。这种非我不可的劲儿，最能证明你爱我。", v: 4}] },
  { id: 21, text: "两个人坐在一起不说话时，你心里的真实活动是？", opts: [{t: "很难受。 如果连话都懒得说，那我们在一起还有什么意思？这种精神上的断连，让我觉得我们像陌生人。", v: 5}, {t: "很慌张。 我会忍不住猜：他为什么不说话？是不是生气了？是不是对我厌倦了？这种未知让我坐立难安。", v: 1}, {t: "很舒服。 各玩各的手机，互不干扰，这种松弛感才是最高级的相处。", v: 6}, {t: "很想找点事做。 我不喜欢这种不知道该干嘛的冷场。与其尴尬地坐着，不如找个话题或者安排点事，打破这个僵局。", v: 3}] },
  { id: 22, text: "如果你在这段关系里付出了很多，你最害怕的结果是？", opts: [{t: "怕你是真的不需要。 我不怕累，但我怕我给你的东西，对你来说是个负担，或者是可有可无的废品。", v: 2}, {t: "怕这只是我的一厢情愿。 感情是双向的，如果只有我一个人在投入，那这就不是爱，是消耗。", v: 8}, {t: "怕你把这当成理所应当。 我对你好是因为我爱你，但如果你连一点特殊的感动都没有，我会瞬间心寒。", v: 4}, {t: "怕被赖上。我怕我一旦开了头，你就会索取更多，我不想因此背上某种很重的义务。", v: 7}] },
  { id: 23, text: "当听到“永远”这个词的时候，你下意识的反应是？", opts: [{t: "松了一口气。 虽然知道未来很难说，但我现在就是太需要这句话了。它能压住我心里所有的不安。", v: 1}, {t: "压力好大。 还没发生的事就先锁死，这让我觉得很沉重。比起承诺“永远”，我更希望“当下开心就好”。", v: 6}, {t: "听听就行。 别光说好听的，关键看你怎么做。没有具体行动支撑的“永远”，对我来说就是一张空头支票。", v: 3}, {t: "很多余。 真正的契合是不需要用时间来担保的。如果我们真的同频，“永远”就是一个自然而然的结果。", v: 5}] },
  { id: 24, text: "在激烈的争吵中，最让你感到绝望、甚至想放弃的一瞬间是？", opts: [{t: "是他推开我的时候。 当他说“不用你管”或者“离我远点”时，我觉得自己像个被丢弃的垃圾。", v: 2}, {t: "是他开始胡搅蛮缠的时候。 当逻辑失效，沟通变成纯粹的情绪发泄，没有任何道理可讲，我觉得这架吵得毫无意义。", v: 8}, {t: "是他站在我对立面的时候。 哪怕我有错，但当你表示帮理不帮亲的时候，我觉得全世界都背叛了我。", v: 4}, {t: "是他逼我立刻说话的时候。 你越逼问“你说话啊”，我越想把自己封闭起来。那种被逼到死角的窒息感，最让我绝望。", v: 7}] },
  { id: 25, text: "哪怕此时此刻什么都没发生，但只要想到这件事，你就会觉得非常有安全感：", opts: [{t: "我知道你会坚定地站在我这边。 不管发生什么风雨，我都清楚地知道你不会权衡利弊，也不会动摇。", v: 1}, {t: "我知道一切都在计划内。 我们的财务、未来规划都是清晰可见的，没有那些乱七八糟的突发状况来打乱生活。", v: 3}, {t: "我知道我是不可替代的。 不是生活上的依赖，而是我能给你别人给不了的快乐或支撑，我在你生命有独特位置。", v: 2}, {t: "我知道我随时可以做自己。 我不需要为了维持关系而伪装或讨好，在你面前我不用戴面具。", v: 6}] },
  { id: 26, text: "如果回想一段失败的感情，最让你觉得“意难平”或者“很受伤”的点可能是？", opts: [{t: "“我居然不是特别的。” 原来我费尽心思去爱，最后在你眼里，我和前任、和其他人也没什么两样。", v: 4}, {t: "“我们从未真正交流过。” 哪怕在一起很久，你也没懂过我哪怕一次。我们像两个住在同一个屋檐下的陌生人。", v: 5}, {t: "“付出没有回报。” 我投入了那么多时间和精力，最后却是一笔烂账，这种严重的不对等让我觉得很亏。", v: 8}, {t: "“我不该全盘托出。” 我后悔把自己最脆弱的一面展示给你看，结果成了你后来攻击我的武器。", v: 7}] },
  { id: 27, text: "你会因为什么事情而产生强烈的嫉妒心或占有欲？", opts: [{t: "当他遇到麻烦却不找我时。 明明我是你最亲近的人，你却去找了外人解决。", v: 2}, {t: "当他对谁都很好的时候。如果你的温柔没有门槛，那它在我这里就一文不值。", v: 4}, {t: "当他有事瞒着我时。 我不一定要干涉，但我必须知情，被蒙在鼓里让我抓狂。", v: 3}, {t: "当他和别人聊得更嗨时。 看到他和别人聊那些跟我聊不起来的话题，还两眼放光，我会觉得属于我的领地被侵犯了。", v: 5}] },
  { id: 28, text: "伴侣出差或不在家，留你一个人独处一周。你的真实感受是？", opts: [{t: "像放假一样爽。 终于不用照顾别人的情绪，不用配合别人的时间。我想几点睡几点睡，这种完全属于自己的时间太珍贵了。", v: 6}, {t: "逐渐开始慌张。 没人说话，家里太安静，我会开始忍不住看手机，期待他发消息过来，确认他还在意我。", v: 1}, {t: "非常自在。 我本来就需要很多独处时间来充电。这种互不打扰的状态，反而让我觉得我们的关系更健康了。", v: 7}, {t: "有点无所适从。 我习惯了把你放在优先级里，时刻想着你的事。突然只需要顾我自己，这种轻飘飘、没重量的感觉，反而让我觉得生活特别不真实。", v: 2}] },
  { id: 29, text: "如果伴侣做了这件事，你会瞬间下头，甚至考虑分手？", opts: [{t: "言而无信。 说好的事变卦，承诺的不兑现。如果连基本的契约精神都没有，这日子没法过。", v: 8}, {t: "拒绝沟通。 当我想聊聊问题，你却说“想太多”或者直接回避。这种拒绝进入我内心的态度，是我的死穴。", v: 5}, {t: "制造混乱。 总是惹麻烦让我收拾烂摊子，或者做事毫无章法搞得生活一团糟，这种“猪队友”我带不动。", v: 3}, {t: "权衡利弊。 如果在关键时刻，你犹豫了，或者为了别的东西牺牲了我的利益，那我绝对不会原谅。", v: 4}] },
  { id: 30, text: "如果给你自己写一份“恋爱使用说明书”，你最希望标注的核心法则是？", opts: [{t: "“请坚定地选择我。” 别犹豫，别摇摆，让我看到你选择我的决心，而不是总让我猜。", v: 1}, {t: "“请允许我做自己。” 别打着“为你好”的名义来改造我，爱我就请接受我原本的样子，包括我的缺点。", v: 6}, {t: "“请看见我的付出。”  看见我的付出，看见我的辛苦。别把一切都当成空气，夸我一句有那么难吗？", v: 2}, {t: "“请给我一点时间。” 别一上来就掏心掏肺，也别逼我马上回应。给我点时间，我才能慢慢打开。", v: 7}] },
  { id: 31, text: "如果让你用一个词来定义你理想中的“关系形态”，你希望你们是？", opts: [{t: "合伙人。 账目分明，分工明确，大家遵守同一个规则，为了共同的未来高效努力。", v: 8}, {t: "船长与领航员。 有明确的方向，有问题能迅速解决。无论风浪多大，这艘船必须在我们的控制之中。", v: 3}, {t: "灵魂伴侣。 哪怕一句话不说，眼神一对就知道对方在想什么。这种不需要磨合的默契，是我唯一的追求。", v: 5}, {t: "两条平行的河。 我们流向同一个大海，但我们有各自的河道。既有交集，又互不吞没，保持各自的完整。", v: 6}] },
  { id: 32, text: "在你看来，一个人爱你的最高级表现是？", opts: [{t: "例外。 他对世界冷漠，唯独对我不一样。这种“排他性”的温柔，才是最高级的爱。", v: 4}, {t: "托底。 无论我变成什么样，或者闯了什么祸，我知道他永远会站在我身后，不会抛弃我。", v: 1}, {t: "依赖。 他愿意把最脆弱、最无助的一面展示给我看，只让我一个人照顾他，这说明他完全把心交给了我。", v: 2}, {t: "尊重。 他从不强迫我改变，也不窥探我的隐私。他懂得站在安全线以外守护我，这种分寸感最打动我。", v: 7}] },
  // Part 3: 灵魂图腾
  { id: 33, text: "如果要把你向往的亲密关系画成一幅画，它最像什么？", opts: [{t: "深深扎进土里的树根。 无论地表风雨多大，地下永远紧紧纠缠，谁也拔不走。", v: 1}, {t: "两朵飘在天上的云。 我们在同一片天空，偶尔重叠，偶尔分开，聚散都随风，轻盈且自由。", v: 6}, {t: "一条笔直的高速公路。 视野开阔，路标清晰，我们握着方向盘，全速驶向同一个终点。", v: 3}, {t: "两面互相照映的镜子。 我看着你，就能看见最深处的自己。这种无声的映照，就是最深的懂得。", v: 5}] },
  { id: 34, text: "如果要把自己比喻成一种动物，在爱人面前，你更像？", opts: [{t: "温顺的大金毛。 我不需要做什么惊天动地的事，你随时感受到陪伴和暖意，我就觉得很满足。", v: 2}, {t: "被驯服的小狐狸。 世上有千千万万只狐狸，但我才对你来说是独一无二的。我只认你这一个“驯养员”。", v: 4}, {t: "屯松果的松鼠。 我喜欢未雨绸缪，一点点把我们的窝填满，规划好过冬的粮食。这种踏实感，是我爱你的方式。", v: 8}, {t: "林间的小鹿。 我生性敏感，如果你愿意站在原地安静地等，我会慢慢试探着靠近你。", v: 7}] },
  { id: 35, text: "闭上眼，你觉得最让你感到安稳的那个空间是？", opts: [{t: "暴雨夜的屋子。 外面狂风大作，屋内灯火通明。你在身边，门窗紧闭，这就是全世界最安全的地方。", v: 1}, {t: "巨大的落地窗。 视野通透，没有围栏。我不希望被墙壁困住，我需要随时能走出去的呼吸感。", v: 6}, {t: "深夜书房。 安静，私密，只有书和思想。我们可以一整晚不睡觉，只谈论灵魂，这是精神的庇护所。", v: 5}, {t: "私有王国。 关上门，这里就是我们的国度。外面的混乱无效，只有我们制定的规则。", v: 3}] },
  { id: 36, text: "如果关系出现危机，你觉得那场景最像什么？", opts: [{t: "荒原。 我拼命呼喊，想要付出，却发现周围空无一人，我的爱变成了没有回声的荒草。", v: 2}, {t: "沼泽。 我被拽住了，越挣扎陷得越深。那种无法抽身的黏腻感，是我最大的噩梦。", v: 7}, {t: "废墟。 原本搭建好的规则、承诺全部崩塌，满地狼藉，一切都失去了原本的逻辑。", v: 8}, {t: "大卖场。 我被放在货架上，和别人打折出售。那种廉价感和可替代感，会瞬间摧毁我。", v: 4}] },
  { id: 37, text: "如果“誓言”是一个具体的物品，你希望它是什么？", opts: [{t: "磐石。 够重、够硬、搬不走。 誓言不该是轻飘飘的话，而是一块压在那里的石头，以此镇住生活中所有的变数。", v: 1}, {t: "风铃。 悦耳，但不沉重。风来时它会响，风走时它静止。它美在当下的回应，而不是永久的束缚。", v: 6}, {t: "契约。 白纸黑字。 它代表的不是浪漫，而是两个清醒的成年人，在理智状态下达成的、不可违背的守则。", v: 3}, {t: "潮汐。 是引力，不是努力。 月亮不需要对大海发誓，潮水也会如约而至。这种不言自明的必然性，才是誓言。", v: 5}] },
  { id: 38, text: "你最喜欢的亲密关系，它的“温度”应该是？", opts: [{t: "滚烫的 100°C。 我喜欢那种沸腾的热情，那种全心全意扑上去的炙热，哪怕会被烫伤也在所不惜。", v: 2}, {t: "微凉的 20°C。 像秋天的风，清爽、不黏人。既不冷漠，也不让人觉得燥热难耐，这才是最长久的。", v: 7}, {t: "恒温的 26°C。 我不要忽冷忽热，我要的是稳定。不管是春夏秋冬，永远保持在这个最舒适的刻度。", v: 8}, {t: "只暖一人的 37°C。它是隐秘的、私有的，是只有我才有资格触碰的特权。", v: 4}] },
  { id: 39, text: "如果爱是一件必须随身携带的物品，你觉得它最像？", opts: [{t: "贴身的护身符。 平时可能感觉不到它的存在，但遇到危险或不安时，摸到它就在那里。", v: 1}, {t: "降噪耳机。 戴上它，世界的嘈杂瞬间消失，只能听到我们想听的旋律。", v: 5}, {t: "瑞士军刀。 精密、锋利、多功能。不管生活抛来什么乱七八糟的难题，我们都能拿它解决。", v: 3}, {t: "一张空白机票。 没有目的地，没有返程日。爱给了我底气，让我去探索更广阔的世界。", v: 6}] },
  { id: 40, text: "如果有一天真的要分开，你希望那是？", opts: [{t: "燃尽。 我像蜡烛一样流干了最后一滴泪，直到再也没有东西可以给你了，我才甘心离场。", v: 2}, {t: "退潮。 没有激烈的争吵，只是自然而然地退去。水面恢复平静，像什么都没发生过一样。", v: 7}, {t: "清算。 我们坐下来，把账算清，把话说开。有一个明确的句号，而不是一个潦草的省略号。", v: 8}, {t: "绝版。 我走之后，你会永远怀念我，因为你再也遇不到像我这样对你好的人了。", v: 4}] },
  { id: 41, text: "你最喜欢的恋爱氛围，像哪种天气？", opts: [{t: "多云有风。 空气是流动的，云是散漫的。没有暴晒的太阳，也没有压抑的雨，清清爽爽，适合散步。", v: 6}, {t: "初雪。 世界突然变得很安静，只剩下白色。这种纯粹、浪漫、又有点稀缺的氛围，最让我心动。", v: 4}, {t: "晴朗无云。 能见度极高，一眼能看到地平线。没有突如其来的雷阵雨，一切都清晰、明朗、可预测。", v: 8}, {t: "深夜雷雨。 窗外狂风暴雨，我们躲在屋里。这种与世隔绝、只有我们俩相依为命的深刻感，最让我着迷。", v: 5}] },
  { id: 42, text: "如果你闭上眼触摸“爱”，手感应该是？", opts: [{t: "晒热的石头。 厚实、干燥、有温度。它并不柔软，但有一种沉甸甸的分量。", v: 1}, {t: "湿软的陶泥。 柔软、依恋。它会填满我指缝的每一处空隙，完全顺应我的力度。", v: 2}, {t: "流动的溪水。 清凉、无重力。它流经我的皮肤，带来触感却不带来负担。", v: 7}, {t: "紧绷的缰绳。 粗糙、有力、有摩擦感。它连接着前方的力量，握住它，我就能控制方向。", v: 3}] },
  { id: 43, text: "你觉得一段好的亲密关系，闻起来应该像？", opts: [{t: "薄荷或海盐。 清冽、透气。吸进去能让肺部扩张，而不是那种甜腻到让人头晕的香水味。", v: 6}, {t: "草莓尖尖。 是那第一口咬下去的甜，带着露水，是特供的、精选的、只留给我的那部分。", v: 4}, {t: "刚晒干的棉被。 干净、干燥、阳光的味道。没有发霉的阴影，只有一种井井有条的生活气息。", v: 8}, {t: "旧书页/焚香。 沉静、悠长。不是为了取悦感官，而是能让人瞬间静下来，闻到时间的味道。", v: 5}] },
  { id: 44, text: "你希望爱人是哪种光源？", opts: [{t: "壁炉里的火。 它需要我不停地添柴，但它能照亮整个屋子。我是那个守护火种的人。", v: 2}, {t: "灯塔。 它是固定的。不管我航行到哪里，只要回头看，那一束光永远在那个位置扫射，从未熄灭。", v: 1}, {t: "月光。 它是温柔的，但也是清冷的。它照亮我，但不会像正午的太阳那样灼伤我。", v: 7}, {t: "手里的火把。 它不靠天赐，而是靠我亲手点燃。我不祈求天亮，我要亲自为你劈开黑暗、照亮前路。", v: 3}] },
  { id: 45, text: "如果把与爱人的相处节奏比作一段旋律，你希望它是？", opts: [{t: "时钟的声音。 滴答滴答，精准、规律。我们按时吃饭，按时睡觉，按部就班地走完这一生。", v: 8}, {t: "随口的哼唱。 没有固定的曲调，也不为了表演。就像散步时随口哼出的小调，断断续续、轻轻松松。", v: 6}, {t: "山谷里的回音。 你发出的每一个声音，无论多微弱，都能在我这里得到回应。因为我们也正好想唱同一首歌。", v: 5}, {t: "为你独奏。 聚光灯打在你身上，而我在为你演奏。那一刻，全世界都是背景音，只有我们是彼此的主角。", v: 4}] },
  { id: 46, text: "如果爱必须伴随一种痛，你宁愿是？", opts: [{t: "生长痛。 像骨骼拉伸一样，虽然酸痛，但说明我们在付出、在羁绊，关系是成长的。", v: 2}, {t: "钝痛。 哪怕关系变得乏味、沉重，也好过那种“不知明天你还在不在”的剧烈撕裂痛。", v: 1}, {t: "幻痛。 哪怕分开了，你也像我身体的一部分。但我宁愿隔着距离怀念，也不愿靠太近互相伤害。", v: 7}, {t: "剥离痛。 像撕开粘在身上的面具和伪装。那种把最真实的软肋赤裸裸暴露给你的恐惧和疼痛，是我们抵达灵魂深处的代价。", v: 5}] },
  { id: 47, text: "如果要把你们共度的时间比作一样东西，它应该是？", opts: [{t: "流沙。 抓得越紧流得越快，不如摊开手掌。让它自然流淌，顺其自然。", v: 6}, {t: "沙漏。 时间是可控的，哪怕流完了，我们也有能力把它倒过来，重新开始下一轮。", v: 3}, {t: "琥珀。 把最美的那一瞬间封存起来，永远晶莹剔透，不被外界的灰尘侵蚀。", v: 4}, {t: "年轮。 一圈一圈，扎扎实实。不管发生什么，每一年都会留下一圈清晰的印记。", v: 8}] },
  { id: 48, text: "最后，请凭直觉填空：爱是______。", opts: [{t: "定数。 是万物流变的世界里，唯一不会更改、也不会撤回的那个答案。", v: 1}, {t: "认出。 是我们在嘈杂的茫茫人海里，精准地辨认出——彼此是唯一的同类。", v: 5}, {t: "成全。 是我们并不互相捆绑，却因此在彼此身边，拥有了更广阔的天空。", v: 6}, {t: "治愈。 是看见了你的破碎，而我甘愿成为那贴唯一有效的药。", v: 2}] }
];

// ==========================================
// 3. React 逻辑 & 视图
// ==========================================

export default function App() {
  const [view, setView] = useState('landing'); // landing, onboarding, quiz, transition, result
  const [code, setCode] = useState('');
  const [errorMsg, setErrorMsg] = useState('');
  const [loading, setLoading] = useState(false);
  
  // 答题相关
  const [qIndex, setQIndex] = useState(0);
  const [scores, setScores] = useState({});
  const [transText, setTransText] = useState('');
  
  // 结果相关
  const [mainId, setMainId] = useState(null);
  const [subId, setSubId] = useState(null);
  const [displayId, setDisplayId] = useState(null); // 当前在结果页展示的ID (主/副切换)
  const [expandedSection, setExpandedSection] = useState({}); // 折叠状态

  // --- 初始化: 检查本地缓存 (断点续传 & 结果缓存) ---
  useEffect(() => {
    const savedRes = localStorage.getItem('psy_result_ids');
    if (savedRes) {
      const { m, s } = JSON.parse(savedRes);
      setMainId(m);
      setSubId(s);
      setDisplayId(m);
      setView('result');
      return;
    }
    const savedProg = localStorage.getItem('psy_progress');
    if (savedProg) {
      const { q, s } = JSON.parse(savedProg);
      setQIndex(q);
      setScores(s);
      setView('onboarding');
    }
  }, []);

  // --- 1. 验证兑换码 ---
  const handleVerify = async () => {
    if (!code.trim()) return;
    setLoading(true); setErrorMsg('');
    try {
      const c = code.trim().toUpperCase();
      const { data, error } = await supabase.from('codes').select('*').eq('code', c).single();
      if (error || !data) throw new Error('无效的兑换码');
      if (data.is_used) throw new Error('此码已被使用');
      await supabase.from('codes').update({ is_used: true }).eq('id', data.id);
      await wait(500);
      setView('onboarding');
    } catch (err) {
      setErrorMsg(err.message);
    } finally {
      setLoading(false);
    }
  };

  // --- 2. 答题逻辑 ---
  const handleAnswer = async (val) => {
    await wait(250); // 选中微反馈
    const newScores = { ...scores, [val]: (scores[val] || 0) + 1 };
    setScores(newScores);
    
    const nextQ = qIndex + 1;
    localStorage.setItem('psy_progress', JSON.stringify({ q: nextQ, s: newScores }));

    // Part 转场
    if (nextQ === 16) {
      setTransText("现实切片已完成\n意识表层正在剥离...");
      setView('transition');
      await wait(2500);
      setQIndex(nextQ); setView('quiz');
    } else if (nextQ === 32) {
      setTransText("情绪暗涌已穿越\n准备进入灵魂图腾...");
      setView('transition');
      await wait(2500);
      setQIndex(nextQ); setView('quiz');
    } else if (nextQ < QUESTIONS.length) {
      setQIndex(nextQ);
    } else {
      finishQuiz(newScores);
    }
  };

  // --- 3. 计算结果 (主副欲望) ---
  const finishQuiz = async (finalScores) => {
    setView('transition'); setTransText("正在潜入潜意识深处\n生成你的情感图谱...");
    localStorage.removeItem('psy_progress');
    await wait(3000);

    // 排序找前两名
    const sorted = Object.entries(finalScores).sort((a, b) => b[1] - a[1]);
    const m = parseInt(sorted[0][0]);
    const s = sorted.length > 1 ? parseInt(sorted[1][0]) : (m === 1 ? 2 : 1); // 兜底

    setMainId(m); setSubId(s); setDisplayId(m);
    localStorage.setItem('psy_result_ids', JSON.stringify({ m, s }));
    setView('result');
  };

  // --- 4. 结果页交互 ---
  const toggleSection = (idx) => {
    setExpandedSection(prev => ({ ...prev, [idx]: !prev[idx] }));
  };

  // 获取当前展示的数据
  const R = displayId ? RESULTS[displayId] : null;
  const META = displayId ? DIM_MAP[displayId] : null;

  // ==========================================
  // 4. 视图渲染
  // ==========================================
  
  return (
    <div className="app-root">
      <Head>
        <title>情感欲望测量 | 柚子的心理小屋</title>
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
        <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;700&display=swap" rel="stylesheet" />
      </Head>

      {/* --- 落地页 --- */}
      {view === 'landing' && (
        <div className="page center">
          <div className="brand-pill">柚子的心理小屋 原创</div>
          <h1 className="hero-title">情感欲望测量</h1>
          <p className="hero-sub">Deep Psychology Test</p>
          <div className="card glass-card">
            <p className="desc">48道深度切片 · 识别你的亲密底色<br/>已有 3,204 人潜入潜意识深海</p>
            <div className="input-group">
              <input value={code} onChange={e=>setCode(e.target.value)} placeholder="在此输入兑换码" />
              <button onClick={handleVerify} disabled={loading}>{loading?'验证中...':'解锁测试'}</button>
            </div>
            {errorMsg && <p className="error">{errorMsg}</p>}
            <a href="https://xiaohongshu.com" className="link">如何获得兑换码？</a>
          </div>
        </div>
      )}

      {/* --- 说明页 --- */}
      {view === 'onboarding' && (
        <div className="page center">
          <div className="card">
            <h2>潜入前知悉</h2>
            <div className="info-item"><span>⏳</span> 全程约 10-15 分钟</div>
            <div className="info-item"><span>🌊</span> 经历：现实/情绪/灵魂 三阶段</div>
            <div className="info-item"><span>🤫</span> 请凭直觉作答，无需思考</div>
            <button className="btn-primary" onClick={() => setView('quiz')}>
              {qIndex > 0 ? `继续进度 (${qIndex}/48)` : '开始潜入'}
            </button>
          </div>
        </div>
      )}

      {/* --- 答题页 --- */}
      {view === 'quiz' && (
        <div className="page quiz-layout">
          <div className="progress-bar">
            <div className="fill" style={{width: `${(qIndex+1)/48*100}%`}}></div>
          </div>
          <div className="quiz-header">
            <span className="part-tag">
              {qIndex<16?'Part 1 现实切片':qIndex<32?'Part 2 情绪暗涌':'Part 3 灵魂图腾'}
            </span>
            <span className="q-num">{qIndex+1} / 48</span>
          </div>
          
          <div className="q-content fade-up" key={qIndex}>
            <h3 className="q-text">{QUESTIONS[qIndex].text}</h3>
            <div className="opts-list">
              {QUESTIONS[qIndex].opts.map((opt, i) => (
                <div key={i} className="opt-card" onClick={() => handleAnswer(opt.v)}>
                  {opt.t}
                </div>
              ))}
            </div>
          </div>
        </div>
      )}

      {/* --- 过场/计算页 --- */}
      {view === 'transition' && (
        <div className="page center">
          <p className="trans-text pulse">{transText}</p>
        </div>
      )}

      {/* --- 结果页 --- */}
      {view === 'result' && R && (
        <div className="page result-layout" style={{background: META.bg}}>
          {/* 1. 顶部切换卡片 (主/副) */}
          <div className="switch-tabs">
            <div className={`tab ${displayId===mainId?'active':''}`} onClick={()=>setDisplayId(mainId)} style={{borderColor: displayId===mainId?META.color:'transparent'}}>
              <span className="role-label">主欲望</span>
              <span className="role-name" style={{color: DIM_MAP[mainId].color}}>{DIM_MAP[mainId].label}</span>
            </div>
            <div className={`tab ${displayId===subId?'active':''}`} onClick={()=>setDisplayId(subId)} style={{borderColor: displayId===subId?META.color:'transparent'}}>
              <span className="role-label">副欲望</span>
              <span className="role-name" style={{color: DIM_MAP[subId].color}}>{DIM_MAP[subId].label}</span>
            </div>
          </div>

          {/* 2. 结果海报区 */}
          <div className="result-poster card" style={{borderTop: `4px solid ${META.color}`}}>
            <div className="poster-header">YOUR EMOTIONAL DESIRE</div>
            <h1 className="res-title" style={{color: META.color}}>{R.title}</h1>
            <div className="totem-pill">{META.totem}</div>
            <p className="quote">“{R.quote}”</p>
            <div className="tags">
              {R.tags.map(t=><span key={t} className="tag">{t}</span>)}
            </div>
            <p className="summary">{R.summary}</p>
          </div>

          {/* 3. 详细报告 (手风琴) */}
          <div className="report-sections">
            {R.sections.map((sec, idx) => (
              <div key={idx} className={`section-card card ${sec.isForPartner ? 'partner-card' : ''}`}>
                <div className="sec-head" onClick={() => toggleSection(idx)}>
                  <span className="sec-title" style={{color: sec.isForPartner ? '#fff' : '#333'}}>
                    {sec.t}
                  </span>
                  <span className="toggle-icon">{expandedSection[idx] ? '收起' : '展开'}</span>
                </div>
                
                {/* 默认显示前100字，展开显示全部 */}
                <div className="sec-body">
                  <p className="content-text">
                    {expandedSection[idx] ? sec.c : sec.c.slice(0, 80) + '...'}
                  </p>
                  {!expandedSection[idx] && (
                    <div className="read-more" onClick={() => toggleSection(idx)}>
                      点击阅读完整解析 ↓
                    </div>
                  )}
                </div>
              </div>
            ))}
          </div>

          {/* 4. 底部品牌 */}
          <div className="footer">
            <button className="btn-outline" onClick={() => {localStorage.clear(); location.reload();}}>
              重新测试
            </button>
            <p className="brand-text">柚子的心理小屋 原创</p>
          </div>
        </div>
      )}

      {/* --- 样式系统 (CSS) --- */}
      <style jsx global>{`
        :root {
          --text-main: #1F2937;
          --text-sub: #6B7280;
          --font: "Noto Serif SC", serif;
          --radius: 16px;
          --shadow: 0 4px 20px rgba(0,0,0,0.06);
        }
        
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { margin: 0; background: #F3F4F6; color: var(--text-main); font-family: -apple-system, sans-serif; }
        
        .page { min-height: 100vh; padding: 24px; position: relative; }
        .center { display: flex; flex-direction: column; align-items: center; justify-content: center; text-align: center; background: #E5E7EB; }
        
        /* 卡片通用 */
        .card { background: #fff; border-radius: var(--radius); padding: 24px; box-shadow: var(--shadow); width: 100%; max-width: 400px; margin-bottom: 20px; transition: 0.3s; }
        .glass-card { background: rgba(255,255,255,0.9); backdrop-filter: blur(10px); }
        
        /* 落地页 */
        .brand-pill { font-size: 12px; color: var(--text-sub); background: #F3F4F6; padding: 4px 12px; border-radius: 20px; display: inline-block; margin-bottom: 20px; }
        .hero-title { font-family: var(--font); font-size: 32px; margin: 0 0 8px; color: #111; }
        .hero-sub { font-size: 12px; letter-spacing: 2px; color: var(--text-sub); margin-bottom: 32px; }
        .desc { font-size: 14px; line-height: 1.6; color: var(--text-sub); margin-bottom: 24px; }
        .input-group input { width: 100%; padding: 14px; border: 1px solid #E5E7EB; border-radius: 8px; margin-bottom: 12px; text-align: center; font-size: 16px; outline: none; }
        .input-group input:focus { border-color: #9CA3AF; }
        .input-group button { width: 100%; background: #1F2937; color: #fff; padding: 14px; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; }
        .error { color: #EF4444; font-size: 12px; margin-top: 8px; }
        .link { display: block; margin-top: 16px; font-size: 12px; color: var(--text-sub); text-decoration: underline; }

        /* 答题页 */
        .quiz-layout { background: #FAFAF9; max-width: 600px; margin: 0 auto; display: flex; flex-direction: column; }
        .progress-bar { position: fixed; top: 0; left: 0; width: 100%; height: 4px; background: #E5E7EB; z-index: 10; }
        .fill { height: 100%; background: #1F2937; transition: width 0.3s; }
        .quiz-header { display: flex; justify-content: space-between; align-items: center; margin: 20px 0 30px; color: var(--text-sub); font-size: 12px; }
        .q-text { font-family: var(--font); font-size: 20px; line-height: 1.6; font-weight: 600; margin-bottom: 32px; color: #111; min-height: 80px; }
        .opts-list { display: flex; flex-direction: column; gap: 16px; }
        .opt-card { background: #fff; padding: 20px; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.03); border: 1px solid transparent; cursor: pointer; transition: 0.2s; font-size: 15px; line-height: 1.5; color: #374151; }
        .opt-card:active { transform: scale(0.98); background: #F3F4F6; }
        .fade-up { animation: fadeUp 0.5s ease; }
        @keyframes fadeUp { from{opacity:0;transform:translateY(10px)} to{opacity:1;transform:translateY(0)} }

        /* 转场 */
        .trans-text { font-family: var(--font); font-size: 18px; line-height: 1.8; color: #4B5563; }
        .pulse { animation: pulse 2s infinite; }
        @keyframes pulse { 0%,100%{opacity:0.6} 50%{opacity:1} }

        /* 结果页 */
        .result-layout { max-width: 600px; margin: 0 auto; padding-top: 80px; }
        
        /* 切换 Tab */
        .switch-tabs { position: fixed; top: 0; left: 0; right: 0; height: 60px; background: rgba(255,255,255,0.9); backdrop-filter: blur(8px); display: flex; justify-content: center; align-items: center; gap: 24px; z-index: 20; border-bottom: 1px solid rgba(0,0,0,0.05); }
        .tab { display: flex; flex-direction: column; align-items: center; padding: 4px 12px; border-bottom: 2px solid transparent; cursor: pointer; opacity: 0.5; transition: 0.3s; }
        .tab.active { opacity: 1; transform: scale(1.05); }
        .role-label { font-size: 10px; color: var(--text-sub); }
        .role-name { font-size: 14px; font-weight: bold; }

        .result-poster { text-align: center; border-radius: 24px; margin-top: 10px; }
        .poster-header { font-size: 10px; letter-spacing: 2px; opacity: 0.5; margin-bottom: 16px; }
        .res-title { font-family: var(--font); font-size: 36px; margin: 0 0 16px; color: #111; }
        .totem-pill { display: inline-block; background: #F3F4F6; padding: 6px 16px; border-radius: 20px; font-size: 12px; color: #4B5563; margin-bottom: 24px; }
        .quote { font-family: var(--font); font-style: italic; font-size: 15px; color: #374151; margin-bottom: 24px; }
        .tags { display: flex; justify-content: center; gap: 8px; margin-bottom: 24px; }
        .tag { font-size: 12px; color: #6B7280; background: #F9FAFB; padding: 4px 8px; border-radius: 4px; }
        .summary { font-size: 14px; line-height: 1.6; color: #4B5563; text-align: left; background: #F9FAFB; padding: 16px; border-radius: 12px; }

        /* 详情卡片 */
        .section-card { padding: 0; overflow: hidden; }
        .sec-head { padding: 20px; display: flex; justify-content: space-between; align-items: center; cursor: pointer; background: #fff; }
        .sec-title { font-weight: bold; font-size: 16px; color: #1F2937; }
        .toggle-icon { font-size: 12px; color: var(--text-sub); }
        .sec-body { padding: 0 20px 24px; color: #4B5563; font-size: 14px; line-height: 1.8; white-space: pre-line; text-align: justify; }
        .read-more { color: #2563EB; text-align: center; margin-top: 10px; font-size: 12px; cursor: pointer; }
        
        /* 给TA的话 特殊样式 */
        .partner-card { background: #1F2937; color: #fff; }
        .partner-card .sec-head { background: #1F2937; border-bottom: 1px solid rgba(255,255,255,0.1); }
        .partner-card .sec-body { color: #D1D5DB; }
        .partner-card .read-more { color: #93C5FD; }

        .footer { text-align: center; padding: 40px 0; }
        .btn-outline { background: none; border: 1px solid #9CA3AF; padding: 10px 24px; border-radius: 20px; color: #4B5563; font-size: 13px; cursor: pointer; margin-bottom: 16px; }
        .brand-text { font-size: 10px; color: #9CA3AF; letter-spacing: 2px; }
      `}</style>
    </div>
  );
}
